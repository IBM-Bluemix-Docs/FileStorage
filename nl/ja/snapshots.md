---

copyright:
  years: 2014, 2018
lastupdated: "2018-05-14"

---
{:new_window: target="_blank"}
{:shortdesc: .shortdesc}

# スナップショット

スナップショットは、{{site.data.keyword.filestorage_full}} の機能です。 スナップショットは、特定の時点のボリュームの内容を表します。 スナップショットにより、パフォーマンスに影響を与えることなく、スペースの使用量を最小限に抑えながらデータを保護できます。スナップショットは、データ保護のための第一線の防御と見なされます。 スナップショット機能を備えたボリュームから重要なデータをユーザーが誤って変更または削除した場合は、スナップショット・コピーからデータを素早く簡単にリストアできます。

{{site.data.keyword.filestorage_short}}には、スナップショットを取得する方法が 2 つあります。1 つ目は、ストレージ・ボリュームごとにスナップショット・コピーを自動的に作成、削除する構成可能なスナップショット・スケジュールを使用する方法です。 追加のスナップショット・スケジュールを作成したり、手動でコピーを削除したり、要件に応じてスケジュールを管理したりすることもできます。 2 つ目は、手動でスナップショットを取得する方法です。

スナップショット・コピーとは、特定の時点のボリュームの状態をキャプチャーした、{{site.data.keyword.filestorage_short}}・ボリュームの読み取り専用イメージです。 スナップショット・コピーは、作成に要する時間とストレージ・スペースの両方の面で非常に効率的です。 ボリュームのサイズやストレージのアクティビティーのレベルに関係なく、{{site.data.keyword.filestorage_short}}・スナップショット・コピーの作成には数秒しかかかりません (通常 1 秒未満です)。 スナップショット・コピーが作成された後、データ・オブジェクトに対する変更は、スナップショット・コピーが存在しないかのように、オブジェクトの現行バージョンに対する更新として反映されます。 この間は、データのコピーは完全に安定したままです。 

スナップショット・コピーではパフォーマンス・オーバーヘッドは発生しません。ユーザーは、{{site.data.keyword.blockstorageshort}}・ボリュームごとにスケジュールによるスナップショット 50 個と手動スナップショット 50 個までを簡単に保管できます。これらはすべて読み取り専用のオンライン・バージョンのデータとしてアクセス可能です。

スナップショットを使用して、以下を行うことができます。

- 中断せずにポイント・イン・タイム・リカバリー・ポイントを作成できます。
- ボリュームを過去の特定の時点に戻せます。
- スナップショットを作成するには、ボリューム用に一定量のスナップショット・スペースを購入する必要があります。 スナップショット・スペースは、ボリュームを最初に注文するときに追加するか、最初のプロビジョニングの後に**「ボリュームの詳細 (Volume Details)」**ページで追加することができます。スケジュールされたスナップショットと手動スナップショットは同じスナップショット・スペースを使用するので、それに応じたスペースを注文してください。 詳細およびガイダンスについては、[スナップショットの注文](ordering-snapshots.html)の記事を参照してください。

## スナップショットのベスト・プラクティス
スナップショットの設計は、お客様の環境によって異なります。 以下の設計上の考慮事項は、スナップショット・コピーの計画および実装に役立ちます。 
- ボリュームまたは LUN ごとに、スケジュールによるスナップショットを最大 50 個、手動によるスナップショットを最大 50 個作成できます。 
- スナップしすぎないように注意してください。 時間単位、日単位、または週単位のスナップショットをスケジュールすることで、スケジュールされたスナップショットの頻度が、RTO および RPO のニーズと、アプリケーションのビジネス要件を満たすようにします。 
- ストレージ消費量の増加を制御するために、スナップショットの自動削除を使用する必要があります。 <br/>
    **注**: 自動削除のしきい値は 95% に固定されています。
    
## スナップショット・コピーがディスク・スペースを使用する方法

スナップショット・コピーは、ファイル全体ではなく個々のブロックを保存することでディスク使用量を最小化します。 アクティブ・ファイル・システム内のファイルが変更または削除された場合にだけ、スナップショット・コピーは追加のスペースを使用し始めます。 この場合、オリジナルのファイル・ブロックはまだ 1 つ以上のスナップショット・コピーの中に保存されています。

アクティブ・ファイル・システム内では、変更されたブロックが、ディスク上の別の場所に再書き込みされたり、アクティブ・ファイル・ブロックとして完全に削除されたりします。 その結果、変更されたアクティブ・ファイル・システム内のブロックに使用されているディスク・スペースに加えて、元のブロックに使用されているディスク・スペースも、変更前のアクティブ・ファイル・システムの状況を表すために保持されます。

<table>
    <colgroup>
      <col style="width: 33.3%;"/>
      <col style="width: 33.3%;"/>
      <col style="width: 33.3%;"/>
    </colgroup>
    <tbody>
      <tr>
        <th colspan="3" style="border: 0.0px;text-align: center;">スナップショット・コピーの前および後のディスク・スペース使用量</th>
     </tr><tr>
        <td style="border: 0.0px;text-align: center;"><img src="/images/bfcircle1.png" alt="スナップショット・コピーの前"></td>
        <td style="border: 0.0px;text-align: center;"><img src="/images/bfcircle3.png" alt="スナップショット・コピーの後"></td>
        <td style="border: 0.0px;text-align: center;"><img src="/images/bfcircle2.png" alt="スナップショット・コピーの後の変更"></td>
     </tr><tr>
        <td style="border: 0.0px;">スナップショット・コピーが作成される前は、アクティブ・ファイル・システムだけがディスク・スペースを使用しています。</td>
        <td style="border: 0.0px;">スナップショット・コピーが作成された後は、アクティブ・ファイル・システムとスナップショット・コピーが同じディスク・ブロックを指しています。 スナップショット・コピーは追加のディスク・スペースを使用しません。</td>
        <td style="border: 0.0px;"><i>myfile.txt</i> がアクティブ・ファイル・システムから削除された後でも、スナップショット・コピーにはまだそのファイルが含まれていて、そのディスク・ブロックを参照しています。 そのため、アクティブ・ファイル・システムのデータを削除しても必ずディスク・スペースが解放されるわけではありません。</td>
      </tr>
    </tbody>
</table>

スナップショット・スペースの使用量を確認するには、[スナップショットの管理](working-with-snapshots.html)のドキュメントの手順に従ってください。
