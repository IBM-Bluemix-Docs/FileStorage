---

copyright:
  years: 2014, 2018
lastupdated: "2018-02-12"

---
{:new_window: target="_blank"}
{:shortdesc: .shortdesc}

# {{site.data.keyword.filestorage_short}}の概説

{{site.data.keyword.filestorage_full}} は、永続的で高速、柔軟な、NFS ベースのネットワーク接続型の{{site.data.keyword.filestorage_short}}です。この Network Attached Storage (NAS) 環境では、ファイル共有機能とパフォーマンスを完全に制御できます{{site.data.keyword.filestorage_short}}共有は、回復力のために経路指定された TCP/IP 接続を介して、最大 64 個の許可デバイスに接続できます。

{{site.data.keyword.filestorage_short}}は、他に例を見ない機能セットと、クラス最高レベルの耐久性と可用性を備えています。
業界標準とベスト・プラクティスを使用して構築されており、一貫したパフォーマンス・ベースラインを提供する一方で、保守イベントや計画外障害の間もデータの整合性を保護して可用性を維持するように設計されています。

{{site.data.keyword.filestorage_short}}の以下のコア機能を利用してください。

- **一貫したパフォーマンス・ベースライン**
   - プロトコル・レベルの IOPS (1 秒あたりの入出力操作数) を個々のボリュームに割り振ることで実現しています。
- **{{site.data.keyword.filestorage_short}}**
   - ファイル・ベースの NFS 共有に使用可能。
- **高い耐久性と回復力**
   - オペレーティング・システム・レベルの RAID (Redundant Arrays of Independent Disks) アレイを作成して管理することなく、保守イベントや計画外の障害の間中、データの整合性を保護して可用性を維持します。
- **保存データの暗号化** [(一部のデータ・センターで使用可能)](new-ibm-block-and-file-storage-location-and-features.html)
   - 追加コストなしの保存データのプロバイダー管理の暗号化。
- **オール・フラッシュ・ストレージ** [(一部のデータ・センターで使用可能)](new-ibm-block-and-file-storage-location-and-features.html)
   - 2 IOPS/GB 以上のエンデュランスまたはパフォーマンスでプロビジョンしたボリュームには、オール・フラッシュ・ストレージが使用されます。
- **スナップショット ([一部のデータ・センター](new-ibm-block-and-file-storage-location-and-features.html)でエンデュランスまたはパフォーマンス・タイプでプロビジョンされた場合)**.
   - 特定時点のデータ・スナップショットを、中断せずにキャプチャーします。
- **レプリケーション** ([一部のデータ・センター](new-ibm-block-and-file-storage-location-and-features.html)でエンデュランスまたはパフォーマンス・タイプでプロビジョンされた場合)
   - パートナーの {{site.data.keyword.BluSoftlayer_full}} データ・センターにスナップショットを自動的にコピーします。
- **高可用性接続**
   - 冗長ネットワーキング接続を使用して可用性を最大限に高めます - NFS ベースの{{site.data.keyword.filestorage_short}}の経路指定 TCP/IP 接続。
- **並行アクセス**
   - 複数のホスト (最大 64 台) が同時にファイル・ボリュームにアクセスできます。
- **クラスター・データベース**
   - クラスター・データベースなど、高度なユース・ケースをサポートします。

## 時間単位/月単位の請求

ファイル・ボリュームの請求を時間単位にするか月単位にするかを選択できます。LUN に対して選択した請求のタイプが、そのスナップショット・スペースとレプリカに適用されます。例えば、時間単位の請求を使用して LUN をプロビジョンした場合、スナップショットやレプリカの料金は時間単位で請求されます。月単位の請求を使用して LUN をプロビジョンした場合、スナップショットやレプリカの料金は月単位で請求されます。 

**時間単位の請求**では、ファイル・ボリュームがアカウントに存在した時間数が、ボリュームが削除されたとき、または請求サイクルの終わりのどちらか早いほうのタイミングで計算されます。時間単位の請求は、使用期間が数日または 1 カ月未満のストレージに適しています。時間単位の請求は、[一部のデータ・センター](new-ibm-block-and-file-storage-location-and-features.html)でプロビジョンされたストレージにのみ使用できます。 

**月単位の請求**では、作成日から請求サイクル終了までの日割り額が計算され、ただちに請求されます。請求サイクルの終了前にファイル・ボリュームが削除されていても、返金は行われません。月単位の請求は、長期間 (1 カ月以上) にわたって保管してアクセスする必要があるデータを使用する実動ワークロード用のストレージに適しています。

 
### パフォーマンス:
<table>
 <tbody>
  <tr>
   <th>月額料金</th>
   <td>$0.10/GB + $0.07/IOP</td>
  </tr>
  <tr>
   <th>時間料金</th>
   <td>$0.0001/GB + $0.0002/IOP</td>
  </tr>
  </tbody>
</table>
 
### エンデュランス:
<table>
 <tbody>
  <tr>
   <th>IOPS ティア</th>
   <th>0.25 IOPS/GB</th>
   <th>2 IOPS/GB</th>
   <th>4 IOPS/GB</th>
   <th>10 IOPS/GB</th>
  </tr>
  <tr>
   <th>月額料金</th>
   <td>$0.10/GB</td>
   <td>$0.20/GB</td>
   <td>$0.35/GB</td>
   <td>$0.58/GB</td>
  </tr>
  <tr>
   <th>時間料金</th>
   <td>0.0002/GB</td>
   <td>$0.0003/GB</td>
   <td>$0.0005/GB</td>
   <td>$0.0009/GB</td>
  </tr>
  </tbody>
</table>

 

## プロビジョニング

{{site.data.keyword.filestorage_short}}・ボリュームは 20 GB から 12 TB までプロビジョンできます。次の 2 つのプロビジョニング・オプションがあります。<br/>
- 事前定義されたパフォーマンス・レベルと、スナップショットやレプリケーションなどの機能を特長とする**エンデュランス・ティア**を使用してプロビジョンする。
- IOPS (1 秒あたりの入出力操作数) の割り振りを指定して強力な**パフォーマンス**環境を構築する。

 
### エンデュランス・ティア

エンデュランスを指定して注文する場合は、さまざまな用途のニーズをサポートする複数のパフォーマンス・ティアの中からいずれかを選択します。

エンデュランスには、さまざまな用途のニーズをサポートする 3 つの IOPS パフォーマンス・ティアが用意されています。

- **0.25 IOPS/GB** は、入出力の負荷が小さいワークロード用に設計されています。このようなワークロードには、いつも大部分のデータが非アクティブであるという代表的な特徴があります。例えば、メールボックスを保管する用途や、部門レベルでファイルを共有する用途などがあります。
- **2 IOPS/GB** は、最も汎用的な用途のために設計されています。例えば、Web アプリケーションで使用する小規模なデータベースや、ハイパーバイザーの仮想マシン・ディスク・イメージをホストする用途があります。
- **4 IOPS/GB** は、高負荷のワークロード用に設計されています。このようなワークロードには、いつも大部分のデータがアクティブであるという代表的な特徴があります。例えば、トランザクション・データベースなどのパフォーマンスが重要なデータベースなどの用途があります。
- **10 IOPS/GB** は、NoSQL データベースで生成されるワークロードや、分析のためのデータ処理など、最も要求の厳しいワークロード用に設計されています。このティアは、[一部のデータ・センター](new-ibm-block-and-file-storage-location-and-features.html)で最大 4 TB のサイズまでプロビジョンされるストレージに使用可能です。

12 TB エンデュランス・ボリュームでは、最大で 48,000 IOPS が使用可能です。


ワークロードに適したエンデュランス・{{site.data.keyword.filestorage_short}}のティアを選択することが鍵ですが、最大パフォーマンスを得るために必要なブロック・サイズ、イーサネット接続速度、ホストの数を使用することも同じように重要です。これらの要素のいずれかが他の要素と合っていないと、結果のスループットに大きな影響を与える可能性があります。
 
### パフォーマンス

パフォーマンスは {{site.data.keyword.filestorage_full}} のクラスの 1 つであり、パフォーマンス要件がよくわかっているけれどもエンデュランス・ティアにはうまく当てはまらないという入出力負荷の高いアプリケーションをサポートするために設計されています。予測可能なパフォーマンスは、プロトコル・レベルの IOPS を個々のボリュームに割り振ることで実現されます。100 から 6,000 までの範囲の IOPS を、20 GB から 12 TB までの範囲のストレージ・サイズでプロビジョンできます。 

{{site.data.keyword.filestorage_short}}のパフォーマンスは、ネットワーク・ファイル・システム (NFS) 接続を介してアクセスされ、マウントされます。{{site.data.keyword.filestorage_short}}は通常、複数のマシンが同時にボリュームにアクセスする場合に使用されます。表 1 のサイズと IOPS に従って一貫したパフォーマンス・ボリュームを注文できます。それらのボリュームは Linux オペレーティング・システムで使用できます。

<table cellpadding="1" cellspacing="1" style="width: 99%;">
        <colgroup>
          <col/>
          <col/>
          <col/>
        </colgroup>
        <tbody>
          <tr>
            <th>サイズ (GB)</th>
            <th>最小 IOPS</th>
            <th>最大 IOPS</th>
          </tr>
          <tr>
            <td>20</td>
            <td>100</td>
            <td>1,000</td>
          </tr>
          <tr>
            <td>40</td>
            <td>100</td>
            <td>2,000</td>
          </tr>
          <tr>
            <td>80</td>
            <td>100</td>
            <td>4,000</td>
          </tr>
          <tr>
            <td>100</td>
            <td>100</td>
            <td>6,000</td>
          </tr>
          <tr>
            <td>250</td>
            <td>100</td>
            <td>6,000</td>
          </tr>
          <tr>
            <td>500</td>
            <td>100</td>
            <td>6,000 または 10,000<sup><img src="/images/numberone.png" alt="脚注" /></sup></td>
          </tr>
          <tr>
            <td>1,000</td>
            <td>100</td>
            <td>6,000 または 20,000<sup><img src="/images/numberone.png" alt="脚注" /></sup></td>
          </tr>
          <tr>
            <td>2,000 から 3,000</td>
            <td>200</td>
            <td>6,000 または 40,000<sup><img src="/images/numberone.png" alt="脚注" /></sup></td>
          </tr>
          <tr>
            <td>4,000 から 7,000</td>
            <td>300</td>
            <td>6,000 または 48,000<sup><img src="/images/numberone.png" alt="脚注" /></sup></td>
          </tr>
          <tr>
            <td>8,000 から 9,000</td>
            <td>500</td>
            <td>6,000 または 48,000<sup><img src="/images/numberone.png" alt="脚注" /></sup></td>
          </tr>
          <tr>
            <td>10,000 から 12,000</td>
            <td>1,000</td>
            <td>6,000 または 48,000<sup><img src="/images/numberone.png" alt="脚注" /></sup></td>
          </tr>
        </tbody>
</table>

<sup>![脚注](/images/numberone.png)</sup>  6,000 を超える IOP 制限は、一部のデータ・センターで使用可能です。


パフォーマンス・ボリュームは、プロビジョンされた IOPS レベルに一貫して近いレベルで実行されるように設計されています。一貫性により、特定のレベルのパフォーマンスのアプリケーション環境を簡単にサイズ変更およびスケーリングできます。さらに、ボリューム・サイズと IOPS カウントの範囲が決まれば、価格対パフォーマンスの割合が理想的なボリュームを構築して環境を最適化できます。

エンデュランスでもパフォーマンスでも、IOPS は 16 KB ブロック・サイズの読み取り/書き込みが 50/50 の割合で混在するものとして測定されます。ボリュームの最大 IOPS を得るには、十分なネットワーク・リソースを配備する必要があります。その他には、ストレージ外でプライベート・ネットワークを使用したり、ホスト側のチューニングやアプリケーションに固有のチューニング (IP スタックやキュー長など) を実行したりすることを検討してください。 

## {{site.data.keyword.filestorage_short}}の IOPS のプロビジョニングのためのヒント

エンデュランスでもパフォーマンスでも、IOPS は 16 KB ブロック・サイズの読み取り/書き込みが 50/50 の割合でランダムに行われるワークロードに基づいています。16 KB 未満のブロックは、ボリュームへの 1 回の書き込みに相当します。

アプリケーションが使用するブロック・サイズは、ストレージのパフォーマンスに直接影響を与えます。アプリケーションが使用するブロック・サイズが 16 KB よりも小さい場合、スループット制限の前に IOP 制限が適用されます。逆に、アプリケーションが使用するブロック・サイズが 16 KB よりも大きい場合は、IOP 制限の前にスループット制限が適用されます。

ブロック・サイズを変更すると、以下のようにパフォーマンスに影響します。

<table cellpadding="1" cellspacing="1" style="width: 99%;">
        <colgroup>
          <col/>
          <col/>
          <col/>
        </colgroup>
        <tbody>
          <tr>
            <th>ブロック・サイズ (KB)</th>
            <th>IOPS</th>
            <th>スループット (MB/秒)</th>
          </tr>
          <tr>
            <td>4 (Linux の場合の標準)</td>
            <td>1,000</td>
            <td>4</td>
          </tr>
          <tr>
            <td>8 (Oracle の場合の標準)</td>
            <td>1,000</td>
            <td>8</td>
          </tr>
          <tr>
            <td>16</td>
            <td>1,000</td>
            <td>16</td>
          </tr>
          <tr>
            <td>32 (SQLServer の場合の標準)</td>
            <td>500</td>
            <td>16</td>
          </tr>          
          <tr>
            <td>64</td>
            <td>250</td>
            <td>16</td>
          </tr>
          <tr>
            <td>128</td>
            <td>128</td>
            <td>16</td>
          </tr>
          <tr>
            <td>512</td>
            <td>32</td>
            <td>16</td>
          </tr>
        </tbody>
</table>

ワークロードに適した{{site.data.keyword.blockstorageshort}}を選択することが重要ですが、いかにボトルネックが防止するかということも同じように重要です。イーサネット接続の速度は、ボリュームに期待する最大スループットよりも速くなければなりません。原則として、イーサネット接続が使用可能帯域幅の 70 % を超えないようにしてください。例えば、6,000 IOPS で 16 KB ブロック・サイズを使用する場合、ボリュームは約 94 MB/秒に対応できます。1 Gbps イーサネットが LUN に接続されている場合、使用可能な最大スループットをサーバーが使用しようとすると、その接続がボトルネックになります。1 Gbps イーサネット接続 (125 MB/秒) の理論上の限界を 70% とすると、88 MB/秒のスループットしか得られないことになるためです。


もう 1 つの考慮事項は、ボリュームを使用するホストの数です。ボリュームにアクセスするホストが 1 つだけの場合、特に IOPS カウントが極端に大きい (10,000 を超える) 場合は、最大 IOPS を実現することが難しい可能性があります。ワークロードが高スループットを必要とする場合は、単一サーバーがボトルネックにならないように、少なくとも 2 つまたは 3 つのサーバーをボリュームにアクセスするように構成することをお勧めします。


最大 IOPS を得るには、十分なネットワーク・リソースを配備する必要があります。その他には、ストレージ外でプライベート・ネットワークを使用したり、ホスト側のチューニングやアプリケーションに固有のチューニング (IP スタックやキュー長など) を実行したりすることを検討してください。

{{site.data.keyword.BluSoftlayer_full}} 環境では NFS v3 と NFS v4.1 の両方がサポートされます。ただし、NFS v3 を使用することをお勧めします。NFS v4.1 は、ステートフル・プロトコルである (NFSv3 のようなステートレス・プロトコルではない) ため、ネットワーク・イベント中にプロトコルの問題が発生する可能性があります。NFS v4.1 では、操作を停止してからロック再利用を行う必要があります。比較的ビジーな NFS ファイル・サーバーでは、待ち時間が長くなって中断が生じる可能性があります。また、NFS v4.1 のマルチパス/トランキングがないため、NFS 操作のリカバリー範囲が広くなる可能性があります。
